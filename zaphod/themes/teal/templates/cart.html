<%inherit file="base.html"/>

<%namespace name="forms" file="common/forms.html"/>
<%namespace name="cart_table" file="common/cart_table.html"/>


<%def name="title()">Shopping Cart</%def>


<%def name="payment_block(renderer, cart, billing, shipping, masked_card)">
  ${forms.ltext(renderer, 'cc.number', label='Card Number')}
  ${forms.ltext(renderer, 'cc.expires_year', label='Expiration Year')}
  ${forms.ltext(renderer, 'cc.expires_month', label='Expiration Month')}
  ${forms.ltext(renderer, 'cc.code', label='CVV Code')}

  ${forms.lcheckbox(renderer, 'save_credit_card', True, label='Save credit card information for future use')}
  ${forms.lcheckbox(renderer, 'billing_same_as_shipping', True, label='Credit card billing address is the same as the shipping address')}

  ${forms.address_fields(renderer, 'billing', billing)}
</%def>


<section class="section-cart-header">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h1 class="text-center">${self.title()}</h1>
      </div>
    </div>
  </div>
</section>


${cart_table.cart_table(cart)}



<section class="section-checkout">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h1 class="text-center">Checkout</h1>
      </div>
    </div>

    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        ${renderer.begin(id='checkout-form', class_='form-horizontal form-wrapped')}

        % if not cart.non_physical:
            <fieldset>
              <legend>Shipping Information</legend>
              ${forms.address_fields(renderer, 'shipping', None)}

            </fieldset>
          % endif

          <fieldset>
            <legend>Payment Information</legend>
            ${self.payment_block(renderer, cart, billing=None, shipping=None, masked_card=None)}
          </fieldset>

          <fieldset>
            <legend>Order Information</legend>
            ${forms.ltext(renderer, 'email', request.user and request.user.email, label='Email Address', required=True, **{'data-required': 'true'})}
            ${forms.ltextarea(renderer, 'comments', rows=4)}
          </fieldset>

          <%forms:actions>
            <button type="submit" class="btn btn-cta">
              <i class="fa fa-lock"></i> Place Secure Order
            </button>
            <span class="submit-hint">This will place your order immediately.</span>
          </%forms:actions>

        ${renderer.end()}
      </div>
    </div>
  </div>
</section>
