<%inherit file="base.html"/>

<%namespace name="blocks" file="common/blocks.html"/>
<%namespace name="cart_table" file="common/cart_table.html"/>
<%namespace name="analytics" file="common/analytics.html"/>


<%def name="title()">Order ${order.id}</%def>


<section class="section-order">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">

        % if first_load:
          <h3>Thank you for your order!</h3>

          <p>Your Crowd Supply order ${order.id} has been confirmed.</p>

          % if not order.cart.non_physical:
            <p>Once your package is ready to ship, you will receive a separate confirmation email with tracking information.</p>
          % endif

          <p>You may view the status of this order at any time by <a href="${request.route_path('login')}">logging into your account</a>. If this is your first Crowd Supply order, you should receive a welcome email shortly.</p>
        % else:

          <ol class="breadcrumb">
            <li><a href="${request.route_path('account')}">Account</a></li>
            <li>Order ${order.id} Details</li>
          </ol>

          <h3>Order Information</h3>

          % if not order.closed:
            <p>You may update your shipping address at any time prior to your order being shipped.</p>
            <a class="btn btn-primary" href="${request.route_path('order:update', id=order.id)}">Update Shipping Address</a>
          % endif

        % endif

        <h4>Email</h4>
        <p>${order.user.email}</p>
        % if order.customer_comments:
          <h4>Comments</h4>
          <p>${order.customer_comments}</p>
        % endif
      </div>
    </div>

    <div class="row">
      <div class="col-sm-6">
        <h4>Shipping Address</h4>
        ${blocks.address(order.shipping)}
      </div>
      <div class="col-sm-6">
        <h4>Billing Address</h4>
        ${blocks.address(order.any_billing)}
      </div>
    </div>
  </div>
</section>


<section class="section-order-contents">
  <div class="container">

    <div class="row">
      <div class="col-lg-12">
        <hr>

        <h3>Order Items</h3>
      </div>
    </div>

    % for item in order.cart.items:
      <div class="row">
        <div class="col-xs-4 col-sm-2 col-md-2">
          ${item.product.img(request, 'product-icon')}
        </div>

        <div class="col-xs-8 col-sm-8 col-md-6">
          <p><a href="${request.node_path(item.product.project)}">${item.product.name}</a></p>
          <h5>${item.product.project.name}</h5>
          ${blocks.option_value_list(item.sku)}
          <p>${cart_table.cart_item_stage(item)}</p>
          <p>Qty ${item.qty_desired} &middot; ${h.currency(item.price_each)} ea.</p>
        </div>
        <div class="col-xs-12 col-sm-2">
          <div class="social-buttons order-social-buttons">
            <h5>Support on Social Media</h5>
            % if item.product.project.status == 'crowdfunding':
              ${blocks.social_buttons(item.product.project, 'I just backed this Crowd Supply project')}
            % else:
              ${blocks.social_buttons(item.product.project, 'I just ordered this on Crowd Supply')}
            % endif
          </div>
        </div>
      </div>
    % endfor

    <div class="row">
      <div class="col-lg-12">
        <hr>

        <p>If you have any questions or need to make changes to this order, please email us at <a href="mailto:${request.registry.settings['mailer.from']}">${request.registry.settings['mailer.from']}</a> or call +1 (800) 554-2014.</p>
      </div>
    </div>

  </div>
</section>


% if first_load:
  ${analytics.google_analytics_ecommerce(order)}
% endif
