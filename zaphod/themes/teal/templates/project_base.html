<%inherit file="base.html"/>

<%namespace name="blocks" file="common/blocks.html"/>

<%def name="title()">${project.name}</%def>


<%def name="breadcrumbs(project)">
  <ol class="breadcrumb">
    <li>Creators</li>
    <li>
      <a href="${request.node_url(project.creator)}">
        ${project.creator.name}
      </a>
    </li>
  </ol>
</%def>


<%def name="tab(suffix)">
  % if suffix == action:
    <li class="active">
      <a href="#">${caller.body()}</a>
    </li>
  % else:
    <li>
      <a href="${request.node_url(project, suffix=[suffix] if suffix else None)}">${caller.body()}</a>
    </li>
  % endif
</%def>


<%def name="project_update(update)">
  <div class="update">
    <div class="update-date pull-right">
      ## FIXME
      ##<p class="month">${update.created_time.strftime('%b')}</p>
      ##<p class="day">${update.created_time.strftime('%d')}</p>
    </div>
    <a href="${request.node_url(update)}"><h3>${update.name}</h3></a>
    <p>${request.render_content(update, update.body)}</p>
    ## FIXME
    ##<div class="clearfix">
    ##  <div class="social-wrap">
    ##    <a href="${h.facebook_share_url(url=request.node_url(update), text='', caption='Crowd Supply Update', name=update.name, image_url='http://%s%s' % (request.host, update.img_url('project-main')), app_id=request.site.settings['facebook.app_id'], redirect_uri=request.url)}">
    ##      <i class="icon-facebook"></i>
    ##    </a>
    ##  </div>
    ##  <div class="social-wrap">
    ##    <a href="${h.twitter_tweet_url(text=update.name, via='crowd_supply', url=request.node_url(update))}">
    ##      <i class="icon-twitter"></i>
    ##    </a>
    ##  </div>
    ##</div>
  </div>
</%def>


<section class="section-project">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        ${self.breadcrumbs(project)}
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12">
        <div class="pull-right">
          % if project.creator.location:
            <p>
              <i class="fa fa-map-marker"></i>&nbsp;
              ${project.creator.location}
            </p>
          % endif
          % for tag in list(project.tags)[:2]:
            % if tag.published:
              <p>
                <i class="fa fa-tag"></i>
                <a href="${request.node_url(tag)}">${tag.name}</a>
              </p>
            % endif
          % endfor
        </div>

        <h1>${project.name}</h1>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12">
        <ul class="nav nav-tabs">
          <%self:tab suffix="">
            Home
          </%self:tab>
          <%self:tab suffix="updates">
            Updates
            ##<span class="badge">${len(project.published_updates)}</span>
          </%self:tab>
          <%self:tab suffix="backers">
            Backers
          </%self:tab>
        </ul>
      </div>
    </div>

    <div class="row">
      <div class="col-md-8">
        ${next.body()}
      </div>
      <div class="col-md-4">
        <div class="project-block">
          ## XXX
          <p>project metadata goes here</p>
        </div>

        <div class="project-block">
          ## XXX
          <p>pledge levels go here</p>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12">
        <div class="project-block">
          <div class="pull-left">
            ${project.creator.img(request, 'creator-profile')}
          </div>

          <h4>${project.creator.name}</h4>
          <div class="creator-block-teaser">${project.creator.teaser}</div>
          <div class="creator-block-metadata">
            <i class="icon-map-marker"></i>&nbsp;${project.creator.location}
            % if project.creator.home_url:
              &nbsp;&middot;&nbsp;
              <a href="${project.creator.home_url}">${project.creator.display_url}</a>
            % endif
          </div>

          <hr>

          <p>Project owners go here...</p>

          ## XXX FIXME
          ##% if project.published_ownerships:
          ##  <div class="row">
          ##    <div class="span12">
          ##      <div class="creator-hr"><hr></div>
          ##    </div>
          ##    % for owner in project.published_ownerships:
          ##      <div class="span3">
          ##        <div class="project-owner">
          ##          ${h.image_or_gravatar(request, owner.account, 'project-avatar', default='mm', title=owner.account.name)}
          ##          <h4>${owner.account.name}</h4>
          ##          <p>${owner.title}</p>
          ##        </div>
          ##      </div>
          ##    % endfor
          ##  </div>
          ##% endif
        </div>
      </div>
    </div>
  </div>
</section>
